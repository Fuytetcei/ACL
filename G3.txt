

PROGRAM Int

LABEL 3

IF SEM=0
SET OUT[4]=0
DELAY 250
SET OUT[4]=1
DELAY 250
ENDIF

GOTO 3
END

PROGRAM S1

LABEL 1

PRINTLN "Esperamos la pieza 1"
 	WAIT IN[1]=1
DEFINE AUX
PEND AUX FROM SEM
PRINTLN "Moviendo el objeto 1"
RUN Int
SPEED 50
MOVED 0
SPEED 30
MOVED 1
OPEN
SPEED 10
MOVED 2
CLOSE
IF ENC[6]>=100
	SET OUT[1]=1
PRINTLN "Error al coger la pieza"
DELAY 200
SET OUT[1]=0
POST 1 TO SEM
GOTO 1
ENDIF
MOVED 1
SPEED 30
MOVED 3
SPEED 10
MOVED 4
OPEN
MOVED 3


SPEED 50
CLOSE
PRINTLN "Pieza 1 clasificada"
POST 1 TO SEM
MOVED 0
GOTO 1
END

PROGRAM S2

LABEL 2

PRINTLN "Esperamos la pieza 2"
 	WAIT IN[2]=1
DEFINE AUX
PEND AUX FROM SEM
PRINTLN "Moviendo el objeto 2"
RUN Int
SPEED 50
MOVED 0
SPEED 30
MOVED 6
OPEN
SPEED 10
MOVED 7
CLOSE
IF ENC[6]>=100
	SET OUT[1]=1
PRINTLN "Error al coger la pieza"
DELAY 200
SET OUT[1]=0
POST 1 TO SEM
GOTO 2
ENDIF
MOVED 6
SPEED 30
MOVED 8
SPEED 10
MOVED 9
OPEN
MOVED 8


SPEED 50
CLOSE
PRINTLN "Pieza 2 clasificada"
POST 1 TO SEM
MOVED 0
GOTO 2
END

PROGRAM Main

GLOBAL SEM
SET SEM=1
SET OUT[4]=1


RUN Int
RUN S1
RUN S2


END
